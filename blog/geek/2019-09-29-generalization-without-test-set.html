<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  
<title> Checking Generalization Without Test and Validation Sets </title>



  <meta name="viewport" content="width=device-width, initial-scale=1">


   <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <!-- jQuery library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <!-- Popper JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <!-- Latest compiled JavaScript -->
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script> 

  <link rel="stylesheet" href="../static/css/main.css">
  
  <link rel='stylesheet' property='stylesheet' id='montserrat700-css'  href='//fonts.googleapis.com/css?family=Montserrat%3A700&#038;ver=4.7.12' type='text/css' media='all' />
  <link rel='stylesheet' property='stylesheet' id='raleway500700-css'  href='//fonts.googleapis.com/css?family=Raleway%3A500%2C700&#038;ver=4.7.12' type='text/css' media='all' />
  <link href="https://fonts.googleapis.com/css?family=Russo+One&display=swap" rel="stylesheet"> 
  <link href="https://fonts.googleapis.com/css?family=Lato&display=swap" rel="stylesheet"> 
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">

  <link rel="stylesheet" href="../pygments.css">

  <!-- Script for working MathJax for Equations Inside Blog -->
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 

    
    
  
<style>

.bg-dark {
    background-color: #000 !important;
}
  .jumbotron
  {
      background-color: #000;
      color: white;
      font-family: Open Sans;
      margin-bottom: 0px;
  }

    .navbar
  {
    font-size: 20px;
  }

  html {
  margin: 0;
  padding: 0;
  height: 100%;
  }

  body
  {
      background: url(../static/images/main_background.jpg); /* https://www.setaswall.com/wp-content/uploads/2018/09/Fractal-Wallpaper-143-1920x1200.jpg); /* url(https://www.setaswall.com/wp-content/uploads/2018/09/Fractal-Wallpaper-060-2560x1600.jpg); /*url(https://www.setaswall.com/wp-content/uploads/2018/09/Fractal-Wallpaper-039-1920x1080.jpg);*/
    font-family: Raleway;
    background-attachment: fixed;
    padding:0;
    margin:0;
    position: relative;
    background-size: cover;
    background-position: right bottom;
  }

  h1, h2, h3, h4, h5, h6 {
    font-family: "Lato"
  }

   #spaceBeforeFooter {
    height: 10px;
    margin: 0;
    padding: 0;
   }

  footer {
      padding-top: 1em;
      background-color: #000;
      color: white;
      padding-bottom: 1em;
      font-family: Raleway;
   }

   footer h2 {
    padding-bottom: 0.2em;
   }

    footer img {
        margin-left: 1.5em;
    }
    footer p {
        font-size: 1.0em;
    }



  .overlay
  {

   background-color: #eeeef6;
   background-color: white;
   margin-top: -30px;
   padding: 20px;
   margin-bottom: 50px;

  }

  .card
  {
    min-height: 110px;
    color: #FBF7F9;
    background-color: #343a40;
  }

  .brand-name
  {
      font-family: Montserrat;
      font-variant: small-caps;
      font-size: 25px;
      font-weight: bold;
      color: #FBF7F9 !important;
      text-decoration: none;
  }

  .nav-item
  {
    font-family: Open Sans;
    font-variant: small-caps;
    color: white;
  }

  .customCard
  {
    margin-bottom: 20px;
   }

   .pointer
   {
   cursor: pointer;
   }


  .image-card
  {
    box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
    max-width: 125px;
    margin: auto;
    margin-bottom: 20px;
    text-align: center;
    font-size: 15px;
    font-family: arial;
  }

  .carousel-item {
      color: black;
      background-color: black !important;
   }

 .carousel-caption {
    top: 50%;
    transform: translateY(-50%);
    bottom: initial;
 }

 .nav-align-left {
  margin-left: 15px;
 }

 .nav-align-right {
  margin-right: 15px;
 }


.dropdown-item.active, .dropdown-item:active {
    color: black;
    background-color: white;
}

.dropdown-item
{
  color: #fff;
  background-color: #000;
  margin-top: -0.5em;
  margin-bottom: 0.5em;
  <!--border: 1px solid #fff;-->
  padding: 10px;
  font-size: 1em;
}
</style>
</head>

<body>
<div class="align-items-center" align="center">
    <div class="d-lg-none navbar navbar-expand-lg bg-dark navbar-dark" >
        <h2 class="navbar-brand brand-name" align="center">
          Kaustubh Vaghmare's <br> <small> Home Page </small></h2>
    </div>
    <div class="d-none d-lg-block navbar navbar-expand-lg bg-dark navbar-dark">
      <h2 class="navbar-brand brand-name" style="margin-left: 0.5em; margin-top: 10px;">  Kaustubh Vaghmare's <br> <small>Home Page</small> </h2>
    </div>
</div>
<div >

    <nav class="navbar navbar-expand-md navbar-light bg-faded bg-dark navbar-dark">
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target=".dual-collapse2">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="navbar-collapse collapse w-100 dual-collapse2 order-1 order-md-0">
            <ul class="navbar-nav mx-auto">
                <li class="nav-item text-center">
                  <a class="nav-link" style="" href="https://vkaustubh.github.io">Home</a>
                </li>
                <li class="nav-item text-center">
                  <a class="nav-link" href="../index.html">Blog Home</a>
                </li>
                <li class="nav-item text-center">
                  <a class="nav-link"
                     href="../general.html">General</a>
                </li>
                <li class="nav-item text-center">
                  <a class="nav-link" href="../geek.html">For Geeks</a>
                </li>
                
            </ul>
        </div>
    </nav>

</div>

<div class="container overlay shadow " style="border-radius:10px; margin-top: 2em;">
  

<div class="col-lg-offset-1 col-lg-8">
    <h2>Checking Generalization Without Test and Validation Sets</h2>
    <span class="date"> Sunday, 29 September, 2019</span>
    <div></div>
    <br/>

    <p><strong>(Note: This article assumes you know your Machine Learning. By that I mean,
you need to understand what a model is, what is meant by the three critical
terms of Machine Learning modeling viz. overfitting, underfitting and
generalization.)</strong></p>
<p>Any decent book on Machine Learning will tell you that the endgame is to
construct a good model. A good model should not underfit i.e. fail to capture
the real patterns present in your data. A good model should not overfit i.e. it
should not capture noise instead of real patterns. A good model should be just
right. When this happens, the model is said to <em>generalize</em> well.</p>
<p>So, how does one go about ensuring that the model does indeed generalize well?
This too is Machine Learning 101. You divide your data into a training and test
set. You train the model using the training data and keep monitoring the metric
of your interest on the test. When you get a model that achieves minimal desired
performance on the training set without compromising the performance on the test
set, your model can be said to generalize well.</p>
<p>But imagine you are a scientist, say an astronomer. And as an astronomer, you
manage to study some 30 galaxies and painfully measure two of their properties X
and Y. You make a plot and find a linear relationship and now you would to do
linear regression in order to model the relationship between X and Y. You feed
your data to one of these many routines available and get back the slope &amp;
intercept of the line. Now, how do you determine if your fit 'generalizes' well?
You do not have the luxury of splitting this simple 30 points data set into a
training and test set! When this question is posed to Machine Learning engineers
(note the word 'engineer'), my guess is that they will start coming up with
<em>exotic</em> methods of upsampling etc.</p>
<p>It turns out that the solution to the problem exists in the field of Statistics
since more than four decades. To understand this solution however one needs to
go to the basics. First off, you need to understand the <strong>Principle of Maximum
Likelihood</strong>. This principle says that 'right model parameters' are those which
maximize the likelihood (probability) of getting the current data set. If you
apply this principle under the following assumptions</p>
<ul>
<li>that the error on Y is a Gaussian</li>
<li>that each measurement is independent</li>
<li>and that all errors on Y are equal (isoskedasticity)</li>
</ul>
<p>the principle will ask you to do a least squares! If you relax the last
assumption, then what you get is something known as chi-square. Here is how it
works.</p>
<p>$$
\chi^2 = \sum_{i=1}^N \left( \frac{y_i - \hat{y}^2 }{\sigma_i} \right)^2
$$</p>
<p>Now, since our measurements y<sub>i</sub>s are Gaussian random variables,
chi-square is also a random variable. This is because it is the sum of the
squares of random variables. Now, it turns out that geniuses from the past
have determined the exact probability distribution that such a quantity is
expected to follow. This distribution is known as a chi-square distribution. It
has a complex mathematical form. It looks something like this:</p>
<p>$$
\chi^2(x) = \frac{x^{k/2-1}\ e^{-x/2}}{2^{k/2}\ \Gamma(k/2)}
$$</p>
<p>But let's look at the curve for various values
of 'k', a parameter of the distribution called <strong>degrees of freedom</strong>.</p>
<p><img alt="Wikipedia Image Showing Chi-Square Distribution" src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/35/Chi-square_pdf.svg/500px-Chi-square_pdf.svg.png" /></p>
<p>We can divide our chi-square by 'k' and get something called reduced chi-square.
This would be mathematically written as,</p>
<p>$$
\chi^2_{k} = \frac{\chi^2}{k} 
$$</p>
<p>This reduced chi-square, as we call it, has the property that its expectation or
average value is one.</p>
<p>$$
\left&lt; \chi^2_{k} \right&gt; = 1
$$</p>
<p>So, if your model is correct, what this distribution is telling you is that
there are some values of chi-square which are more probable than others.</p>
<p>So, let's say that you get a reduced chi-square which is far greater than 1.
Given the correct model, the chances of this happening are very low. Thus we say
that the model is underfitting. Note that generally for chi-square to be very
large, there has to be a strong disagreement between the predicted values of the
model and the actual values of the model.</p>
<p>Consider the opposite case. You get a reduced chi-squared which is far less
than one. Given the correct model, the probability of this happening is also far
too low. The model is then said to be overfitting. Note that generally for
chi-square to be very low, the predicted values of the model are almost equal to
the actual values.</p>
<p>There you have it! A several decades old solution to commenting on overfitting
and underfitting without doing a train-test split! Now, I completely acknowledge
that you must be dazed and confused. That is because we have skipped a lot of
details. There are textbooks written on this topic. My job was to merely present
a condensed description of how statistics enables the answer to my original
question.</p>
<p>But if you are interested in a more detail explanation by me, there is a video
recording of my lecture on this topic available at the link below.</p>
<p><a href="https://www.youtube.com/watch?v=ZoEVLTc-svA">Probability Distributions: What They Are And How Scientists Use Them</a>
(talk delivered at PyData Pune April 2019 Meeting)</p>
<p><a href="https://www.youtube.com/watch?v=ZoEVLTc-svA"> <img class="img"
width="300px" src="../static/images/blog_images/PyDataScreenShot.png"></a></p>
    <br/>
    <br/>
    <br/>

    <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
var disqus_config = function () {
    this.page.url = 'https://vkaustubh.github.io/blog/geek/2019-09-29-generalization-without-test-set.html';  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = 'geek/2019-09-29-generalization-without-test-set'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://vkaustubh-blog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

</div>

<footer>

    <div class="container">
        <div align="center">
          The web site has been created using Bootstrap, Django/django-freeze starting from a blank file. Background image courtesy of <a href="https://www.setaswall.com/">SetAsWell</a>. All rights reserved. Copyright &copy; 2019.
        </div>
    </div>

</footer>

       <a id="back-to-top" href="#" class="btn btn-primary btn-lg back-to-top" role="button" 
         data-toggle="tooltip" data-placement="left"><span class="glyphicon
             glyphicon-chevron-up"> Up </span></a>

<script src="static/js/scroll_top.js"></script>

<!-- Configuration for MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX", "output/HTML-CSS"],
    tex2jax: {
      inlineMath: [ ['$','$'], ["\(","\)"] ],
      processEscapes: true
    },
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>

</body>
</html>